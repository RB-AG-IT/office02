<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auffälligkeiten - RB Inside Office</title>
    <link rel="stylesheet" href="../css/styles.css">
    <script src="../js/main.js"></script>
    <style>
        body {
            overflow-y: auto;
            height: 100%;
            margin: 0;
            background: var(--bg-secondary);
        }

        .page-container {
            padding: var(--spacing-lg);
            max-width: 1600px;
            margin: 0 auto;
        }

        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-lg);
        }

        .page-title {
            font-size: 22px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .page-subtitle {
            font-size: 13px;
            color: var(--text-secondary);
            margin-top: 2px;
        }

        /* Stats Bar - kompakter */
        .stats-bar {
            display: flex;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-lg);
            flex-wrap: wrap;
        }

        .stat-chip {
            display: flex;
            align-items: center;
            gap: 8px;
            background: var(--bg-primary);
            border-radius: 20px;
            padding: 6px 14px;
            font-size: 13px;
            font-weight: 500;
        }

        .stat-chip-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .stat-chip-dot.red { background: #ef4444; }
        .stat-chip-dot.green { background: #10b981; }
        .stat-chip-dot.yellow { background: #f59e0b; }

        .stat-chip-value {
            font-weight: 700;
            color: var(--text-primary);
        }

        .stat-chip-label {
            color: var(--text-secondary);
        }

        /* Filter Tabs - kompakter */
        .filter-tabs {
            display: flex;
            gap: 4px;
            background: var(--bg-primary);
            padding: 3px;
            border-radius: 8px;
            margin-bottom: var(--spacing-md);
        }

        .filter-tab {
            padding: 6px 12px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            font-size: 12px;
            font-weight: 500;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .filter-tab:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .filter-tab.active {
            background: var(--accent-color);
            color: white;
        }

        .filter-badge {
            font-size: 10px;
            padding: 1px 5px;
            border-radius: 8px;
            background: rgba(255,255,255,0.2);
            font-weight: 600;
        }

        .filter-tab:not(.active) .filter-badge {
            background: var(--bg-hover);
        }

        /* Kompakte Alert-Liste */
        .alerts-list {
            background: var(--bg-primary);
            border-radius: 10px;
            overflow: hidden;
        }

        .alert-row {
            display: grid;
            grid-template-columns: 36px 90px 1fr 140px 100px 90px 100px 32px;
            gap: 12px;
            align-items: center;
            padding: 10px 14px;
            border-bottom: 1px solid var(--border-color);
            transition: background 0.15s;
            cursor: pointer;
        }

        .alert-row:last-child {
            border-bottom: none;
        }

        .alert-row:hover {
            background: var(--bg-hover);
        }

        /* Avatar - kleiner */
        .avatar-sm {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--color-werber);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 11px;
            font-weight: 600;
            flex-shrink: 0;
        }

        /* Type Badge - kompakt */
        .type-badge {
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            text-align: center;
        }

        .type-badge.quality { background: rgba(239, 68, 68, 0.1); color: #ef4444; }
        .type-badge.schrieb { background: rgba(16, 185, 129, 0.1); color: #10b981; }
        .type-badge.anomaly { background: rgba(245, 158, 11, 0.1); color: #f59e0b; }
        .type-badge.ruecklage { background: rgba(139, 92, 246, 0.1); color: #8b5cf6; }

        /* Info Bereich */
        .alert-info {
            min-width: 0;
        }

        .alert-name {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .alert-campaign {
            font-size: 11px;
            color: var(--text-secondary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* Metriken */
        .metric {
            text-align: center;
        }

        .metric-value {
            font-size: 14px;
            font-weight: 700;
        }

        .metric-value.danger { color: #ef4444; }
        .metric-value.warning { color: #f59e0b; }
        .metric-value.success { color: #10b981; }
        .metric-value.highlight { color: var(--accent-color); }

        .metric-label {
            font-size: 9px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        /* Mini Progress Bar */
        .mini-progress {
            width: 100%;
            height: 4px;
            background: var(--bg-secondary);
            border-radius: 2px;
            margin-top: 3px;
            overflow: hidden;
        }

        .mini-progress-fill {
            height: 100%;
            border-radius: 2px;
        }

        .mini-progress-fill.danger { background: #ef4444; }
        .mini-progress-fill.warning { background: #f59e0b; }
        .mini-progress-fill.success { background: #10b981; }

        /* Status Badge */
        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 500;
        }

        .status-badge.new {
            background: rgba(239, 68, 68, 0.1);
            color: #ef4444;
        }

        .status-badge.reviewing {
            background: rgba(245, 158, 11, 0.1);
            color: #f59e0b;
        }

        .status-badge.resolved {
            background: rgba(16, 185, 129, 0.1);
            color: #10b981;
        }

        .status-dot {
            width: 5px;
            height: 5px;
            border-radius: 50%;
            background: currentColor;
        }

        /* Timestamp */
        .timestamp {
            font-size: 11px;
            color: var(--text-secondary);
            text-align: right;
        }

        /* Action Button */
        .action-btn {
            width: 28px;
            height: 28px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.15s;
        }

        .action-btn:hover {
            background: var(--bg-secondary);
            color: var(--accent-color);
        }

        .action-btn .icon {
            width: 16px;
            height: 16px;
        }

        /* Header Row */
        .header-row {
            display: grid;
            grid-template-columns: 36px 90px 1fr 140px 100px 90px 100px 32px;
            gap: 12px;
            padding: 8px 14px;
            background: var(--bg-secondary);
            font-size: 10px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .header-row > div {
            display: flex;
            align-items: center;
        }

        .header-row .center {
            justify-content: center;
        }

        .header-row .right {
            justify-content: flex-end;
        }

        /* Detail Panel (expandable) */
        .alert-details {
            display: none;
            grid-column: 1 / -1;
            padding: 12px 14px;
            background: var(--bg-secondary);
            border-radius: 6px;
            margin: 8px 14px 10px;
        }

        .alert-row.expanded .alert-details {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
        }

        .detail-item {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .detail-label {
            font-size: 10px;
            color: var(--text-secondary);
            text-transform: uppercase;
        }

        .detail-value {
            font-size: 13px;
            font-weight: 500;
            color: var(--text-primary);
        }

        .detail-actions {
            display: flex;
            gap: 8px;
            margin-top: 12px;
            grid-column: 1 / -1;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .alert-row, .header-row {
                grid-template-columns: 36px 80px 1fr 100px 80px 90px 32px;
            }
            .metric:nth-child(5) {
                display: none;
            }
        }

        @media (max-width: 900px) {
            .alert-row, .header-row {
                grid-template-columns: 36px 70px 1fr 90px 80px 32px;
            }
            .timestamp {
                display: none;
            }
        }
    </style>
</head>
<body >
    <div class="content-area">
        <!-- Alerts List -->
        <div class="alerts-list">
            <!-- Header -->
            <div class="header-row">
                <div></div>
                <div>Typ</div>
                <div>Mitarbeiter / Kampagne</div>
                <div class="center">Hauptwert</div>
                <div class="center">Details</div>
                <div class="center">Status</div>
                <div class="right">Zeit</div>
                <div></div>
            </div>

            <!-- Quality Alert 1 -->
            <div class="alert-row" data-type="quality" onclick="toggleDetails(this)">
                <div class="user-badge user-badge--werber user-badge--small">
                    <div class="user-badge__avatar">TM</div>
                    <div class="user-badge__info">
                        <span class="user-badge__name">Tim Müller</span>
                        <span class="user-badge__type">Werber</span>
                    </div>
                </div>
                <span class="type-badge quality">Quality</span>
                <div class="alert-info">
                    <div class="alert-campaign">Frühjahrskampagne 2024 - Ludwigshafen</div>
                </div>
                <div class="metric">
                    <div class="metric-value danger">12.5%</div>
                    <div class="metric-label">Stornoquote</div>
                    <div class="mini-progress"><div class="mini-progress-fill danger" style="width: 83%;"></div></div>
                </div>
                <div class="metric">
                    <div class="metric-value">8/64</div>
                    <div class="metric-label">Storniert</div>
                </div>
                <span class="status-badge new"><span class="status-dot"></span>Neu</span>
                <div class="timestamp">Heute, 14:32</div>
                <button class="action-btn" onclick="event.stopPropagation(); markReviewed(this);" title="Als geprüft markieren">
                    <span class="icon icon--check"></span>
                </button>
                <div class="alert-details">
                    <div class="detail-item">
                        <span class="detail-label">Schwellenwert</span>
                        <span class="detail-value">10% (+2.5 PP überschritten)</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Bonus-Status</span>
                        <span class="detail-value" style="color: #ef4444;">Kein Bonus</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Letzter Schrieb</span>
                        <span class="detail-value">Gestern, 16:30</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Trend</span>
                        <span class="detail-value" style="color: #ef4444;">↑ +1.2% diese Woche</span>
                    </div>
                    <div class="detail-actions">
                        <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); viewEmployee('tim-mueller')">Profil</button>
                        <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); viewRecords('tim-mueller')">Datensätze</button>
                    </div>
                </div>
            </div>

            <!-- Quality Alert 2 -->
            <div class="alert-row" data-type="quality" onclick="toggleDetails(this)">
                <div class="user-badge user-badge--werber user-badge--small">
                    <div class="user-badge__avatar">PH</div>
                    <div class="user-badge__info">
                        <span class="user-badge__name">Peter Hoffmann</span>
                        <span class="user-badge__type">Werber</span>
                    </div>
                </div>
                <span class="type-badge quality">Quality</span>
                <div class="alert-info">
                    <div class="alert-campaign">Sommerkampagne 2024 - Mannheim</div>
                </div>
                <div class="metric">
                    <div class="metric-value warning">9.2%</div>
                    <div class="metric-label">Stornoquote</div>
                    <div class="mini-progress"><div class="mini-progress-fill warning" style="width: 61%;"></div></div>
                </div>
                <div class="metric">
                    <div class="metric-value">6/65</div>
                    <div class="metric-label">Storniert</div>
                </div>
                <span class="status-badge reviewing"><span class="status-dot"></span>Prüfung</span>
                <div class="timestamp">Gestern, 16:45</div>
                <button class="action-btn" onclick="event.stopPropagation(); markReviewed(this);" title="Als geprüft markieren">
                    <span class="icon icon--check"></span>
                </button>
                <div class="alert-details">
                    <div class="detail-item">
                        <span class="detail-label">Schwellenwert</span>
                        <span class="detail-value">8% (+1.2 PP überschritten)</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Bonus-Status</span>
                        <span class="detail-value" style="color: #f59e0b;">Reduziert</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Gesamte EH</span>
                        <span class="detail-value">312 EH</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Trend</span>
                        <span class="detail-value" style="color: #10b981;">↓ -0.3% diese Woche</span>
                    </div>
                    <div class="detail-actions">
                        <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); viewEmployee('peter-hoffmann')">Profil</button>
                        <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); viewRecords('peter-hoffmann')">Datensätze</button>
                    </div>
                </div>
            </div>

            <!-- Quality Alert 3 -->
            <div class="alert-row" data-type="quality" onclick="toggleDetails(this)">
                <div class="user-badge user-badge--werber user-badge--small">
                    <div class="user-badge__avatar">SK</div>
                    <div class="user-badge__info">
                        <span class="user-badge__name">Stefan Kraus</span>
                        <span class="user-badge__type">Werber</span>
                    </div>
                </div>
                <span class="type-badge quality">Quality</span>
                <div class="alert-info">
                    <div class="alert-campaign">Herbstkampagne 2024 - Heidelberg</div>
                </div>
                <div class="metric">
                    <div class="metric-value danger">14.8%</div>
                    <div class="metric-label">Stornoquote</div>
                    <div class="mini-progress"><div class="mini-progress-fill danger" style="width: 99%;"></div></div>
                </div>
                <div class="metric">
                    <div class="metric-value">12/81</div>
                    <div class="metric-label">Storniert</div>
                </div>
                <span class="status-badge new"><span class="status-dot"></span>Neu</span>
                <div class="timestamp">Heute, 10:15</div>
                <button class="action-btn" onclick="event.stopPropagation(); markReviewed(this);" title="Als geprüft markieren">
                    <span class="icon icon--check"></span>
                </button>
                <div class="alert-details">
                    <div class="detail-item">
                        <span class="detail-label">Schwellenwert</span>
                        <span class="detail-value">12% (+2.8 PP überschritten)</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Bonus-Status</span>
                        <span class="detail-value" style="color: #ef4444;">Kein Bonus</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Einsatztage</span>
                        <span class="detail-value">8 Tage</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Trend</span>
                        <span class="detail-value" style="color: #ef4444;">↑ +2.1% diese Woche</span>
                    </div>
                    <div class="detail-actions">
                        <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); viewEmployee('stefan-kraus')">Profil</button>
                        <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); viewRecords('stefan-kraus')">Datensätze</button>
                    </div>
                </div>
            </div>

            <!-- Quality Alert 4 -->
            <div class="alert-row" data-type="quality" onclick="toggleDetails(this)">
                <div class="user-badge user-badge--werber user-badge--small">
                    <div class="user-badge__avatar">NW</div>
                    <div class="user-badge__info">
                        <span class="user-badge__name">Nina Weber</span>
                        <span class="user-badge__type">Werber</span>
                    </div>
                </div>
                <span class="type-badge quality">Quality</span>
                <div class="alert-info">
                    <div class="alert-campaign">Frühjahrskampagne 2024 - Ludwigshafen</div>
                </div>
                <div class="metric">
                    <div class="metric-value danger">16.2%</div>
                    <div class="metric-label">Stornoquote</div>
                    <div class="mini-progress"><div class="mini-progress-fill danger" style="width: 100%;"></div></div>
                </div>
                <div class="metric">
                    <div class="metric-value">15/93</div>
                    <div class="metric-label">Storniert</div>
                </div>
                <span class="status-badge new"><span class="status-dot"></span>Neu</span>
                <div class="timestamp">Heute, 08:30</div>
                <button class="action-btn" onclick="event.stopPropagation(); markReviewed(this);" title="Als geprüft markieren">
                    <span class="icon icon--check"></span>
                </button>
                <div class="alert-details">
                    <div class="detail-item">
                        <span class="detail-label">Schwellenwert</span>
                        <span class="detail-value">15% (+1.2 PP überschritten)</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Bonus-Status</span>
                        <span class="detail-value" style="color: #ef4444;">Kein Bonus</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Einsatztage</span>
                        <span class="detail-value">12 Tage</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Trend</span>
                        <span class="detail-value" style="color: #ef4444;">↑ +0.8% diese Woche</span>
                    </div>
                    <div class="detail-actions">
                        <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); viewEmployee('nina-weber')">Profil</button>
                        <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); viewRecords('nina-weber')">Datensätze</button>
                    </div>
                </div>
            </div>

            <!-- Quality Alert 5 -->
            <div class="alert-row" data-type="quality" onclick="toggleDetails(this)">
                <div class="user-badge user-badge--werber user-badge--small">
                    <div class="user-badge__avatar">FG</div>
                    <div class="user-badge__info">
                        <span class="user-badge__name">Felix Graf</span>
                        <span class="user-badge__type">Werber</span>
                    </div>
                </div>
                <span class="type-badge quality">Quality</span>
                <div class="alert-info">
                    <div class="alert-campaign">Sommerkampagne 2024 - Mannheim</div>
                </div>
                <div class="metric">
                    <div class="metric-value warning">8.5%</div>
                    <div class="metric-label">Stornoquote</div>
                    <div class="mini-progress"><div class="mini-progress-fill warning" style="width: 57%;"></div></div>
                </div>
                <div class="metric">
                    <div class="metric-value">5/59</div>
                    <div class="metric-label">Storniert</div>
                </div>
                <span class="status-badge resolved"><span class="status-dot"></span>Geprüft</span>
                <div class="timestamp">Vor 3 Tagen</div>
                <button class="action-btn" style="opacity: 0.3; pointer-events: none;">
                    <span class="icon icon--check"></span>
                </button>
                <div class="alert-details">
                    <div class="detail-item">
                        <span class="detail-label">Schwellenwert</span>
                        <span class="detail-value">8% (+0.5 PP überschritten)</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Bonus-Status</span>
                        <span class="detail-value" style="color: #f59e0b;">Reduziert (-1 PP)</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Einsatztage</span>
                        <span class="detail-value">10 Tage</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Geprüft von</span>
                        <span class="detail-value">M. Schmidt</span>
                    </div>
                    <div class="detail-actions">
                        <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); viewEmployee('felix-graf')">Profil</button>
                    </div>
                </div>
            </div>

            <!-- Schrieb Alert 1 -->
            <div class="alert-row" data-type="schrieb" onclick="toggleDetails(this)">
                <div class="user-badge user-badge--werber user-badge--small">
                    <div class="user-badge__avatar">AS</div>
                    <div class="user-badge__info">
                        <span class="user-badge__name">Anna Schneider</span>
                        <span class="user-badge__type">Werber</span>
                    </div>
                </div>
                <span class="type-badge schrieb">Schrieb</span>
                <div class="alert-info">
                    <div class="alert-campaign">Frühjahrskampagne 2024 - Ludwigshafen</div>
                </div>
                <div class="metric">
                    <div class="metric-value success">480 JE</div>
                    <div class="metric-label">Jahreseuros</div>
                </div>
                <div class="metric">
                    <div class="metric-value highlight">40 EH</div>
                    <div class="metric-label">Einheiten</div>
                </div>
                <span class="status-badge new"><span class="status-dot"></span>Neu</span>
                <div class="timestamp">Heute, 11:23</div>
                <button class="action-btn" onclick="event.stopPropagation(); markReviewed(this);" title="Als geprüft markieren">
                    <span class="icon icon--check"></span>
                </button>
                <div class="alert-details">
                    <div class="detail-item">
                        <span class="detail-label">Mitglied</span>
                        <span class="detail-value">Klaus Reichert</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Ort</span>
                        <span class="detail-value">Ludwigshafen</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Monatsbeitrag</span>
                        <span class="detail-value">40,00 €</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Zahlungsart</span>
                        <span class="detail-value">SEPA-Lastschrift</span>
                    </div>
                    <div class="detail-actions">
                        <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); viewRecord('nmg-12345')">Datensatz</button>
                        <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); viewEmployee('anna-schneider')">Profil</button>
                    </div>
                </div>
            </div>

            <!-- Schrieb Alert 2 -->
            <div class="alert-row" data-type="schrieb" onclick="toggleDetails(this)">
                <div class="user-badge user-badge--werber user-badge--small">
                    <div class="user-badge__avatar">LB</div>
                    <div class="user-badge__info">
                        <span class="user-badge__name">Lisa Bauer</span>
                        <span class="user-badge__type">Werber</span>
                    </div>
                </div>
                <span class="type-badge schrieb">Schrieb</span>
                <div class="alert-info">
                    <div class="alert-campaign">Frühjahrskampagne 2024 - Ludwigshafen</div>
                </div>
                <div class="metric">
                    <div class="metric-value success">600 JE</div>
                    <div class="metric-label">Jahreseuros</div>
                </div>
                <div class="metric">
                    <div class="metric-value highlight">50 EH</div>
                    <div class="metric-label">Einheiten</div>
                </div>
                <span class="status-badge new"><span class="status-dot"></span>Neu</span>
                <div class="timestamp">Heute, 15:48</div>
                <button class="action-btn" onclick="event.stopPropagation(); markReviewed(this);" title="Als geprüft markieren">
                    <span class="icon icon--check"></span>
                </button>
                <div class="alert-details">
                    <div class="detail-item">
                        <span class="detail-label">Mitglied</span>
                        <span class="detail-value">Dr. Werner Braun</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Ort</span>
                        <span class="detail-value">Heidelberg</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Monatsbeitrag</span>
                        <span class="detail-value">50,00 €</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Zahlungsart</span>
                        <span class="detail-value">SEPA-Lastschrift</span>
                    </div>
                    <div class="detail-actions">
                        <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); viewRecord('nmg-12347')">Datensatz</button>
                        <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); viewEmployee('lisa-bauer')">Profil</button>
                    </div>
                </div>
            </div>

            <!-- Schrieb Alert 3 -->
            <div class="alert-row" data-type="schrieb" onclick="toggleDetails(this)">
                <div class="user-badge user-badge--werber user-badge--small">
                    <div class="user-badge__avatar">MK</div>
                    <div class="user-badge__info">
                        <span class="user-badge__name">Max Klein</span>
                        <span class="user-badge__type">Werber</span>
                    </div>
                </div>
                <span class="type-badge schrieb">Schrieb</span>
                <div class="alert-info">
                    <div class="alert-campaign">Sommerkampagne 2024 - Mannheim</div>
                </div>
                <div class="metric">
                    <div class="metric-value success">360 JE</div>
                    <div class="metric-label">Jahreseuros</div>
                </div>
                <div class="metric">
                    <div class="metric-value highlight">30 EH</div>
                    <div class="metric-label">Einheiten</div>
                </div>
                <span class="status-badge resolved"><span class="status-dot"></span>Geprüft</span>
                <div class="timestamp">Gestern, 09:15</div>
                <button class="action-btn" style="opacity: 0.3; pointer-events: none;">
                    <span class="icon icon--check"></span>
                </button>
                <div class="alert-details">
                    <div class="detail-item">
                        <span class="detail-label">Mitglied</span>
                        <span class="detail-value">Maria Gruber</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Ort</span>
                        <span class="detail-value">Mannheim</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Monatsbeitrag</span>
                        <span class="detail-value">30,00 €</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Geprüft von</span>
                        <span class="detail-value">T. Wagner</span>
                    </div>
                    <div class="detail-actions">
                        <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); viewRecord('nmg-12346')">Datensatz</button>
                    </div>
                </div>
            </div>

            <!-- Anomaly Alert 1 -->
            <div class="alert-row" data-type="anomaly" onclick="toggleDetails(this)">
                <div class="user-badge user-badge--werber user-badge--small">
                    <div class="user-badge__avatar">MK</div>
                    <div class="user-badge__info">
                        <span class="user-badge__name">Max Klein</span>
                        <span class="user-badge__type">Werber</span>
                    </div>
                </div>
                <span class="type-badge anomaly">Anomalie</span>
                <div class="alert-info">
                    <div class="alert-campaign">Ungewöhnliche Leistungssteigerung</div>
                </div>
                <div class="metric">
                    <div class="metric-value warning">+339%</div>
                    <div class="metric-label">Steigerung</div>
                </div>
                <div class="metric">
                    <div class="metric-value">18→79</div>
                    <div class="metric-label">EH/Tag</div>
                </div>
                <span class="status-badge new"><span class="status-dot"></span>Neu</span>
                <div class="timestamp">Heute, 18:00</div>
                <button class="action-btn" onclick="event.stopPropagation(); markReviewed(this);" title="Als geprüft markieren">
                    <span class="icon icon--check"></span>
                </button>
                <div class="alert-details">
                    <div class="detail-item">
                        <span class="detail-label">Vortag</span>
                        <span class="detail-value">18 EH</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Heute</span>
                        <span class="detail-value" style="color: #f59e0b;">79 EH</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Wochenschnitt</span>
                        <span class="detail-value">25 EH/Tag</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Kampagne</span>
                        <span class="detail-value">Sommerkampagne 2024</span>
                    </div>
                    <div class="detail-actions">
                        <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); viewEmployee('max-klein')">Profil</button>
                        <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); viewDayDetails('max-klein', '2024-11-26')">Tagesdetails</button>
                    </div>
                </div>
            </div>

            <!-- Anomaly Alert 2 -->
            <div class="alert-row" data-type="anomaly" onclick="toggleDetails(this)">
                <div class="user-badge user-badge--werber user-badge--small">
                    <div class="user-badge__avatar">JS</div>
                    <div class="user-badge__info">
                        <span class="user-badge__name">Julia Schmidt</span>
                        <span class="user-badge__type">Werber</span>
                    </div>
                </div>
                <span class="type-badge anomaly">Anomalie</span>
                <div class="alert-info">
                    <div class="alert-campaign">Starker Leistungsabfall</div>
                </div>
                <div class="metric">
                    <div class="metric-value danger">-84%</div>
                    <div class="metric-label">Rückgang</div>
                </div>
                <div class="metric">
                    <div class="metric-value">45→7</div>
                    <div class="metric-label">EH/Tag</div>
                </div>
                <span class="status-badge reviewing"><span class="status-dot"></span>Prüfung</span>
                <div class="timestamp">Gestern, 19:30</div>
                <button class="action-btn" onclick="event.stopPropagation(); markReviewed(this);" title="Als geprüft markieren">
                    <span class="icon icon--check"></span>
                </button>
                <div class="alert-details">
                    <div class="detail-item">
                        <span class="detail-label">Wochenschnitt</span>
                        <span class="detail-value">45 EH/Tag</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Gestern</span>
                        <span class="detail-value" style="color: #ef4444;">7 EH</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Mögliche Ursache</span>
                        <span class="detail-value">Zu prüfen</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Kampagne</span>
                        <span class="detail-value">Frühjahrskampagne 2024</span>
                    </div>
                    <div class="detail-actions">
                        <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); viewEmployee('julia-schmidt')">Profil</button>
                        <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); viewDayDetails('julia-schmidt', '2024-11-25')">Tagesdetails</button>
                    </div>
                </div>
            </div>

            <!-- Rücklage Alert 1 - Warnung -->
            <div class="alert-row" data-type="ruecklage" onclick="toggleDetails(this)">
                <div class="user-badge user-badge--werber user-badge--small">
                    <div class="user-badge__avatar">PH</div>
                    <div class="user-badge__info">
                        <span class="user-badge__name">Peter Hoffmann</span>
                        <span class="user-badge__type">Werber</span>
                    </div>
                </div>
                <span class="type-badge ruecklage">Rücklage</span>
                <div class="alert-info">
                    <div class="alert-campaign">Stornorücklage Q2 2023 - Warnung</div>
                </div>
                <div class="metric">
                    <div class="metric-value warning">28%</div>
                    <div class="metric-label">Verbleibend</div>
                    <div class="mini-progress"><div class="mini-progress-fill warning" style="width: 28%;"></div></div>
                </div>
                <div class="metric">
                    <div class="metric-value">840 €</div>
                    <div class="metric-label">von 3.000 €</div>
                </div>
                <span class="status-badge new"><span class="status-dot"></span>Neu</span>
                <div class="timestamp">Heute, 09:00</div>
                <button class="action-btn" onclick="event.stopPropagation(); markReviewed(this);" title="Als geprüft markieren">
                    <span class="icon icon--check"></span>
                </button>
                <div class="alert-details">
                    <div class="detail-item">
                        <span class="detail-label">Ursprüngliche Rücklage</span>
                        <span class="detail-value">3.000 €</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Stornos bisher</span>
                        <span class="detail-value" style="color: #ef4444;">-2.160 €</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Schwellenwert</span>
                        <span class="detail-value">30% (Warnung bei Unterschreitung)</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Freigabe geplant</span>
                        <span class="detail-value">Q3 2025 (Juli)</span>
                    </div>
                    <div class="detail-actions">
                        <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); viewEmployee('peter-hoffmann')">Profil</button>
                        <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); viewAbrechnung('peter-hoffmann')">Abrechnung</button>
                    </div>
                </div>
            </div>

            <!-- Rücklage Alert 2 - Kritisch -->
            <div class="alert-row" data-type="ruecklage" onclick="toggleDetails(this)">
                <div class="user-badge user-badge--werber user-badge--small">
                    <div class="user-badge__avatar">SK</div>
                    <div class="user-badge__info">
                        <span class="user-badge__name">Stefan Kraus</span>
                        <span class="user-badge__type">Werber</span>
                    </div>
                </div>
                <span class="type-badge ruecklage">Rücklage</span>
                <div class="alert-info">
                    <div class="alert-campaign">Stornorücklage Q3 2023 - KRITISCH</div>
                </div>
                <div class="metric">
                    <div class="metric-value danger">12%</div>
                    <div class="metric-label">Verbleibend</div>
                    <div class="mini-progress"><div class="mini-progress-fill danger" style="width: 12%;"></div></div>
                </div>
                <div class="metric">
                    <div class="metric-value">420 €</div>
                    <div class="metric-label">von 3.500 €</div>
                </div>
                <span class="status-badge new"><span class="status-dot"></span>Neu</span>
                <div class="timestamp">Heute, 09:00</div>
                <button class="action-btn" onclick="event.stopPropagation(); markReviewed(this);" title="Als geprüft markieren">
                    <span class="icon icon--check"></span>
                </button>
                <div class="alert-details">
                    <div class="detail-item">
                        <span class="detail-label">Ursprüngliche Rücklage</span>
                        <span class="detail-value">3.500 €</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Stornos bisher</span>
                        <span class="detail-value" style="color: #ef4444;">-3.080 €</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Schwellenwert</span>
                        <span class="detail-value" style="color: #ef4444;">15% (KRITISCH bei Unterschreitung)</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Risiko</span>
                        <span class="detail-value" style="color: #ef4444;">Kaskade oder Vorschuss-Abzug droht!</span>
                    </div>
                    <div class="detail-actions">
                        <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); viewEmployee('stefan-kraus')">Profil</button>
                        <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); viewAbrechnung('stefan-kraus')">Abrechnung</button>
                        <button class="btn btn-primary btn-sm" onclick="event.stopPropagation(); createAction('stefan-kraus')">Maßnahme</button>
                    </div>
                </div>
            </div>
        </div>
    </div>  <!-- Ende content-area -->

    <script>
        // Filter functionality
        document.querySelectorAll('.toolbar-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                document.querySelectorAll('.toolbar-tab').forEach(t => t.classList.remove('active'));
                this.classList.add('active');

                const filter = this.dataset.filter;
                const rows = document.querySelectorAll('.alert-row');

                rows.forEach(row => {
                    if (filter === 'all' || row.dataset.type === filter) {
                        row.style.display = 'grid';
                    } else {
                        row.style.display = 'none';
                    }
                });
            });
        });

        // Toggle details
        function toggleDetails(row) {
            row.classList.toggle('expanded');
        }

        // Mark as reviewed
        function markReviewed(button) {
            const row = button.closest('.alert-row');
            const statusBadge = row.querySelector('.status-badge');

            statusBadge.className = 'status-badge resolved';
            statusBadge.innerHTML = '<span class="status-dot"></span>Geprüft';

            button.style.opacity = '0.3';
            button.style.pointerEvents = 'none';
        }

        // Navigation functions
        function viewEmployee(employeeId) {
            parent.location.hash = 'employees';
        }

        function viewRecord(recordId) {
            parent.location.hash = 'records';
        }

        function viewRecords(employeeId) {
            parent.location.hash = 'records';
        }

        function viewDayDetails(employeeId, date) {
            parent.location.hash = 'statistics';
        }

        function viewAbrechnung(employeeId) {
            // Navigate to werber abrechnung page
            window.location.href = '../abrechnungen/werber.html?id=' + employeeId;
        }

        async function createAction(employeeId) {
            await showAlert('Maßnahmen', 'Maßnahmen-Dialog für ' + employeeId + ':\n\n- Gespräch mit Werber führen\n- Schulung ansetzen\n- Rücklagen-Übertrag prüfen\n- Vorschuss-Anpassung prüfen', 'info');
        }

        async function exportAlerts() {
            await showAlert('Export', 'Export-Funktion wird implementiert...', 'info');
        }

        // ========== SHELL INTEGRATION ==========
        // Listen for messages from shell
        window.addEventListener('message', function(e) {
            if (e.data && e.data.type === 'searchQuery') {
                handleSearch(e.data.query);
            }
        });

        // Search/filter function
        function handleSearch(query) {
            const search = query.toLowerCase().trim();
            // Filter alert rows
            document.querySelectorAll('.alert-row').forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(search) ? '' : 'none';
            });
        }

        // ========== STUFEN-BADGES DYNAMISCH HINZUFÜGEN ==========
        // Werber-Stufen Mapping (zentral aus badge-system.js)
        const werberStufen = {
            'TM': 'EMA',   // Tim Müller
            'PH': 'JMM',   // Peter Hoffmann
            'SK': 'SMA',   // Stefan Kraus
            'NW': 'EMM',   // Nina Weber
            'FG': 'SMA',   // Felix Graf
            'AS': 'CEMM',  // Anna Schneider
            'LB': 'JMM',   // Lisa Bauer
            'MK': 'EMA',   // Max Klein
            'JS': 'SPB'    // Julia Schmidt
        };

        // Stufen-Badges zu allen Werber-Avataren hinzufügen
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.user-badge--werber .user-badge__avatar').forEach(avatar => {
                const initials = avatar.textContent.trim();
                const stufe = werberStufen[initials];
                if (stufe && typeof getStufeBadge === 'function') {
                    avatar.innerHTML = initials + getStufeBadge(stufe);
                }
            });
        });
    </script>
</body>
</html>
